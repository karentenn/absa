var absa=absa||{};absa.apps=absa.apps||{};absa.apps.avafGadget=absa.apps.avafGadget||{};absa.apps.avafGadget.onTradeInCarRadioGroupChange=function(a){var g=bb.selector.queryAncestor(a,".ap-avafOffers-form");var b=bb.selector.query(g,".ap-avafOffers-tradeInRow");var h=bb.selector.query(g,".ap-avafOffers-tradeIn");var e=bb.selector.query(g,".ap-avafOffers-hiddenMonthlyInstAmt");var j=bb.selector.query(g,".ap-avafOffers-hiddenBalloonAmt");var d=phe.radioGroup.getValue(a);if(d=="Yes"){phe.row.setAttribute(b,"class","ap-avafOffers-tradeInRow");phe.textBox.setAttribute(h,"required","true")}else{phe.row.setAttribute(b,"class","ap-avafOffers-tradeInRow ap-common-hide");phe.textBox.setValue(h,"");var i=0;var c=0;var f=absa.apps.avafGadget.computeMonthlyInst(i);phe.hiddenField.setValue(e,f);phe.hiddenField.setValue(j,c);absa.gadgets.avafGadget.computeVehicleValue(a)}};absa.apps.avafGadget.onBalloonPaymentRadioGroupChange=function(f){var k=bb.selector.queryAncestor(f,".ap-avafOffers-form");var e=bb.selector.query(k,".ap-avafOffers-balloonPayment");var g=bb.selector.query(k,".ap-avafOffers-balloonPrcntText");var c=bb.selector.query(k,".ap-avafOffers-balloonSlider");var b=bb.selector.query(k,".ap-avafOffers-balloonAmtRow");var o=bb.selector.query(document.body,".ap-avafOffers-balloonAmt");var n=bb.selector.query(k,".ap-avafOffers-loanTerm");var m=bb.selector.query(document.body,".ap-avafOffers-hiddenBalloonAmt");var l=phe.radioGroup.getValue(f);var a=phe.hiddenField.getValue(n);var i=bb.selector.query(k,".ap-avafOffers-balloonSlider");if(l=="Yes"){phe.row.setAttribute(e,"class","ap-avafOffers-balloonPayment");phe.slider.initializeBehavior(i);phe.row.setAttribute(b,"class","ap-avafOffers-balloonAmtRow");if(a==72||a==60||a==48){phe.row.setAttribute(g,"class","ap-avafOffers-balloonPrcntText")}}else{phe.row.setAttribute(e,"class","ap-avafOffers-balloonPayment ap-common-hide");phe.row.setAttribute(b,"class","ap-avafOffers-balloonAmtRow ap-common-hide");phe.row.setAttribute(g,"class","ap-avafOffers-balloonPrcntText ap-common-hide");var d=parseInt(5);var h="R 0.00";var j=parseInt(0);phe.slider.setValue(c,d);phe.inputReadOnlyText.setValue(o,h);phe.hiddenField.setValue(m,j);absa.gadgets.avafGadget.computeVehicleValue(f)}};absa.apps.avafGadget.onTradeInAmountTextChange=function(g){var f=bb.selector.queryAncestor(g,".ap-avafOffers-form");var e=bb.selector.query(f,".ap-avafOffers-tradeIn");var d=bb.selector.query(f,".ap-avafOffers-hiddenMonthlyInstAmt");var a="";var c=phe.textBox.getValue(g);if(isNaN(c)||c==""){a=0}else{a=parseInt(c)}var b=absa.apps.avafGadget.computeMonthlyInst(a);phe.hiddenField.setValue(d,b);absa.gadgets.avafGadget.computeVehicleValue(g)};absa.apps.avafGadget.onDepositAmountTextChange=function(f){var e=bb.selector.queryAncestor(f,".ap-avafOffers-form");var c=bb.selector.query(e,".ap-avafOffers-depositAmount");var d=bb.selector.query(e,".ap-avafOffers-hiddenDepositAmt");var b="";var a=phe.textBox.getValue(c);if(isNaN(a)||a==""){b=0}else{b=parseInt(a)}phe.hiddenField.setValue(d,b);absa.gadgets.avafGadget.computeVehicleValue(f)};absa.apps.avafGadget.computeMonthlyInst=function(c){var f=bb.selector.query(document.body,".ap-avafOffers-monthlyInstFromSer");var h=bb.selector.query(document.body,".ap-avafOffers-monthlyInst");var b=bb.selector.query(document.body,".ap-avafOffers-balloonSlider");var j=bb.selector.query(document.body,".ap-avafOffers-balloonAmt");var i=parseInt(phe.hiddenField.getValue(f));var e=i+(c*0.75);var a=absa.util.formatCurrency(e);var d=parseInt(5);var g="R 0.00";phe.slider.setValue(b,d);phe.inputReadOnlyText.setValue(h,a);phe.inputReadOnlyText.setValue(j,g);return e};absa.apps.avafGadget.onTermSlide=function(a){var d=bb.selector.queryAncestor(a,".ap-avafOffers-form");var c=bb.selector.query(d,".ap-avafOffers-loanTerm");var b=absa.apps.avafGadget.getTermSliderSelection(a);phe.hiddenField.setValue(c,b);absa.gadgets.avafGadget.computeVehicleValue(a)};absa.apps.avafGadget.getTermSliderSelection=function(g){var p=bb.selector.queryAncestor(g,".ap-avafOffers-form");var q=bb.selector.query(p,".ap-avafOffers-balloonSlider");var j=bb.selector.query(p,".ap-avafOffers-hiddenBalloonAmt");var t=bb.selector.query(p,".ap-avafOffers-balloonAmt");var d=bb.selector.query(p,".ap-avafOffers-balloonPrcnt");var i=bb.selector.query(p,".ap-avafOffers-balloonPrcntText");var r=bb.selector.query(p,".ap-avafOffers-balloonPrcntMonths");var l=bb.selector.query(document.body,".ap-avafOffers-balloonRadio");var c="";var f="";var a="";var k=phe.radioGroup.getValue(l);var m=parseInt(phe.slider.getValue(g));var o=parseInt(phe.slider.getAttribute(g,"keyStep"));var e=parseInt(phe.slider.getAttribute(g,"max"));if(m==e){m--}var u=parseInt(e/(parseInt(o)));var b=parseInt(m/u);var s=(u*b)+(u/2);phe.slider.setValue(g,s);if(s==55){c=parseInt(72);stepMidValueballoon=5;a="15%";if(k=="Yes"){phe.row.setAttribute(i,"class","ap-avafOffers-balloonPrcntText")}}else{if(s==45){c=parseInt(60);stepMidValueballoon=5;a="20%";if(k=="Yes"){phe.row.setAttribute(i,"class","ap-avafOffers-balloonPrcntText")}}else{if(s==35){c=parseInt(48);stepMidValueballoon=5;a="25%";if(k=="Yes"){phe.row.setAttribute(i,"class","ap-avafOffers-balloonPrcntText")}}else{if(s==25){c=parseInt(36);stepMidValueballoon=5;phe.row.setAttribute(i,"class","ap-avafOffers-balloonPrcntText ap-common-hide")}else{if(s==15){c=parseInt(24);stepMidValueballoon=5;phe.row.setAttribute(i,"class","ap-avafOffers-balloonPrcntText ap-common-hide")}else{if(s==5){c=parseInt(12);stepMidValueballoon=5;phe.row.setAttribute(i,"class","ap-avafOffers-balloonPrcntText ap-common-hide")}}}}}}if(stepMidValueballoon==5){var n="R 0.00";var h=parseInt(0);phe.hiddenField.setValue(j,h);phe.inputReadOnlyText.setValue(t,n)}phe.slider.setValue(q,stepMidValueballoon);phe.inputReadOnlyText.setValue(d,a);phe.inputReadOnlyText.setValue(r,c);return c};absa.apps.avafGadget.onBalloonPercentSlide=function(j){var l=bb.selector.queryAncestor(j,".ap-avafOffers-form");var q=bb.selector.query(l,".ap-avafOffers-hiddenBalloonAmt");var e=absa.apps.avafGadget.getBalloonSliderSelection(j);var n=bb.selector.query(l,".ap-avafOffers-hiddenInterestRate");var b=phe.hiddenField.getValue(n);var k=bb.selector.query(l,".ap-avafOffers-hiddenMonthlyInstAmt");var m=phe.hiddenField.getValue(k);var p=bb.selector.query(l,".ap-avafOffers-balloonAmt");var o=bb.selector.query(l,".ap-avafOffers-loanTerm");var a=phe.hiddenField.getValue(o);var c=(b/100)/12;var g=1/Math.pow((1+c),a);var d=m*((1-g)/c);var i=absa.util.formatCurrency(d);var h="";var f="";if(e>=5){h=parseInt(d*(e/100));f=absa.util.formatCurrency(h)}else{h=0;f=absa.util.formatCurrency(h)}phe.hiddenField.setValue(q,h);phe.inputReadOnlyText.setValue(p,f);absa.gadgets.avafGadget.computeVehicleValue(j)};absa.apps.avafGadget.getBalloonSliderSelection=function(e){var i=bb.selector.queryAncestor(e,".ap-avafOffers-form");var k=bb.selector.query(i,".ap-avafOffers-loanTerm");var a=phe.hiddenField.getValue(k);var j=parseInt(phe.slider.getValue(e));var h="";var c="";var f=parseInt(phe.slider.getAttribute(e,"keyStep"));var b=parseInt(phe.slider.getAttribute(e,"max"));if(j==b){j--}phe.slider.setValue(e,h);var g=parseInt(b/(parseInt(f)));var d=parseInt(j/g);if((a==72)&&(d>3)){d=3}else{if((a==60)&&(d>4)){d=4}else{if((a==48)&&(d>5)){d=5}}}h=(g*d)+(g/2);phe.slider.setValue(e,h);if(h==5){c=parseInt(0)}else{if(h==15){c=parseInt(5)}else{if(h==25){c=parseInt(10)}else{if(h==35){c=parseInt(15)}else{if(h==45){c=parseInt(20)}else{if(h==55){c=parseInt(25)}else{if(h==65){c=parseInt(30)}}}}}}}return c};absa.apps.avafGadget.onApplyRadioGroupChange=function(c){var d=bb.selector.queryAncestor(c,".ap-avafOffers-form");var a=bb.selector.query(d,".ap-avafOffers-applyButton");var b=bb.selector.query(d,".ap-avafOffers-sendButton");var e=phe.radioGroup.getValue(c);if(e=="0"){phe.button.setAttribute(a,"class","ap-avafOffers-applyButton ap-avafOffers-buttonPadding ap-button-next ");phe.button.setAttribute(b,"class","ap-avafOffers-sendButton ap-avafOffers-buttonPadding ap-button-next ap-common-hide")}else{phe.button.setAttribute(a,"class","ap-avafOffers-applyButton ap-avafOffers-buttonPadding ap-button-next ap-common-hide");phe.button.setAttribute(b,"class","ap-avafOffers-sendButton ap-avafOffers-buttonPadding ap-button-next ")}};absa.apps.avafGadget.onApply=function(c,a){var i=bb.selector.queryAncestor(c,".ap-avafOffers-form");var g=bb.selector.query(i,".ap-avafOffers-applyButton");if(absa.form.validate(i)){if(a=="0"){var f="https://e.absa.co.za/vehiclefin/ClientSearch.do";var d=document.body.getAttribute("sid");var h="<div style='display:none;'><form novalidate name='osfAvafloginform' id='osfAvafloginform' action='"+f+"' method='post'>";h=h+"<input type='hidden' name='esessionid' id='esessionid' class='input' value='"+d+"' />";h=h+"<input type='submit' name='osfAvafsubmit' id='osfAvafsubmit' value='Login' />";h=h+"</form></div>";h=h+"<script type='text/javascript'>";h=h+"document.osfAvafloginform.submit();<\/script>";openWindow=window.open("","OSF_AVAF");openWindow.document.write(h);openWindow.document.close();absa.apps.avafGadget.onDoneButtonClick(g);var e="AVAF_APPLY_OFFERS";var b="proxy?pipe=genericWebservice&ws=OffersTransactionalApplyWebService&action=updateApplyFlagAndLoggingForOffersGadgets&productType="+e;absa.io.makeRequest(b,function(j){})}else{phe.form.setAttribute(i,"action","proxy?pipe=genericWebservice&ws=OffersAVAFWebService&action=sendAVAFEmailMessage");absa.form.validateAndSubmit(i)}}};absa.apps.avafGadget.onDoneButtonClick=function(b){var c=bb.selector.queryAncestor(b,".p-gadget");var a=bb.getControllerFromView(c);if(a){a.minimize();c.focus()}};absa.apps.avafGadget.onUnsubscribeClick=function(d,a){phe.common.hide(document.getElementById("gadget-placeholder-l2-g3010140"));phe.common.hide(document.getElementById("gadget-placeholder-l5-g3010140"));gadgets.pubsub.publish("showHide:offersSpoofContainer","HIDE");var c="AVAF";var b="proxy?pipe=genericWebservice&ws=SnoozeProcessWebService&action=persistSnoozedData&source="+a+"&functionName="+c;absa.io.makeRequest(b,function(e){})};