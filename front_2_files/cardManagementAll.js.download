absa.apps.viewCardPin=absa.apps.viewCardPin||{};absa.apps.viewCardPin.onStepOneCallBack=function(l){var c=bb.selector.queryAncestor(l,".ap-viewCardPin-wizard");var b=bb.selector.query(c,".ap-applyForPersonalLoan-step2Form");var f=phe.form.getAttribute(b,"data-countDown")*1;var j=bb.selector.query(b,".app-viewCardPin-timeRemaining");var k=bb.selector.query(b,".app-viewCardPin-refNo-hiddenField");var g=bb.selector.query(b,".app-viewCardPin-PAN-hiddenField");var i=bb.selector.query(b,".app-viewCardPin-refNo-hiddenField");var h=bb.selector.query(l,".ap-viewCardPin-stepOneErrorMessage");var e=phe.hiddenField.getValue(b,g);var d=phe.hiddenField.getValue(b,i);var m=phe.hiddenField.getValue(b,k);var a=absa.index.cardPin.extractPinFromPinBlock(e,d,m);if(!isNAN(a)){absa.apps.viewCardPin.doCountdown(j,f)}else{phe.message.show(h);phe.message.setMessage(h,a);phe.wizard.selectStepAbsolute(h,0)}};absa.apps.viewCardPin.onStepOneNextButtonClick=function(b){var j=bb.selector.queryAncestor(b,"#ap-cardManagement");var h=bb.selector.queryAncestor(b,".ap-viewCardPin-form");var a=phe.form.getAttribute(h,"context");var f=phe.form.getAttribute(h,"proxy");var c=bb.selector.query(h,".ap-viewCardPin-CardNumber-select");if(c!=null){var i=phe.select.getValue(c);if(i!=null){var d=i.split("-");var e=d[0];var g=d[1];phe.loadingMessage.showLoadingMessage(j);absa.xd.makeXDRequest(a,f,"/j_card_pin_block_cache","cardIndex="+g+"&cardNumber="+e,function(k,l){absa.apps.viewCardPin.getCardPinHandler(h,k,l)})}}};absa.apps.viewCardPin.getCardPinHandler=function(m,f,b){var n=bb.selector.queryAncestor(m,"#ap-cardManagement");var j=bb.selector.query(m,".ap-viewCardPin-stepOneErrorMessage");var c=bb.selector.query(m,".ap-viewCardPin-displayPin");if(bb.browser.gecko){c.textContent=""}else{c.innerText=""}var l=bb.selector.queryAll(m,".ap-viewCardPin-displayPin-row");phe.common.hide(l[0]);phe.common.hide(l[1]);var p=bb.selector.query(m,".ap-button-cancel");var k=bb.selector.query(m,".ap-button-next");var i=bb.selector.query(m,".ap-button-finish");if(f.success==true){phe.message.hide(j);var h=f.cardPinBlock;var e=h.split("|");var g=e[2];var d=e[3].substring(g.length);var o=e[4].substring(0,e[4].indexOf("]"));var a=absa.index.cardPin.extractPinFromPinBlock(g,d,o);if(bb.browser.gecko){c.textContent=a}else{c.innerText=a}phe.common.show(l[0]);phe.common.show(l[1]);phe.common.hide(p);phe.common.hide(k);phe.common.show(i);setTimeout(function(){if(bb.browser.gecko){c.textContent=""}else{c.innerText=""}phe.common.hide(l[0]);phe.common.hide(l[1]);phe.common.show(p);phe.common.show(k);phe.common.hide(i)},10000)}else{phe.message.show(j);phe.message.setMessage(j,f.errorMessage);phe.wizard.selectStepAbsolute(j,0)}phe.loadingMessage.hideLoadingMessage(n)};absa.apps.viewCardPin.doCountdown=function(d,a){if(((a*1)-1)<=0){var c=bb.selector.queryAncestor(d,".ap-viewCardPin-form");var b=bb.selector.query(c,".ap-viewCardPin-pinGrid");if(bb.browser.gecko){b.textContent=""}else{b.innerText=""}return}else{a-=1;if(bb.browser.gecko){d.textContent=a}else{d.innerText=a}absa.viewCardPin._timer2=setTimeout(function(){absa.apps.viewCardPin.doCountdown(d,a)},1000)}};absa.apps.manageCardLimits=absa.apps.manageCardLimits||{};absa.apps.manageCardLimits.tabBoxClass;absa.apps.manageCardLimits.loadData=function(b){b="."+b;absa.apps.manageCardLimits.tabBoxClass=b;var d=bb.selector.query(window.document,b);var a=phe.tabBox.getCurrentTabBody(d);var g=bb.selector.query(a,".ap-manageCardLimits-form");if(g){var c=bb.selector.query(g,".ap-viewCardLimits-cardNumber-select");var f=bb.selector.query(g,".ap-cardlimits-content");var e="proxy?pipe=genericWebservice&ws=ProfileWebService&action=getCardATMandPosLimits&combiCardNumber="+phe.select.getValue(c);phe.common.setAttribute(f,"proxyurl",e);absa.lazyLoadNode(f,true)}};absa.apps.manageCardLimits.onChangeButtonClick=function(c,b,d){var e=bb.selector.queryAncestor(c,".ap-manageCardLimits-form");var a=bb.selector.query(e,".ap-viewCardLimits-cardNumber-select");b+="&combiCardNumber="+phe.select.getValue(a);absa.modal.loadModal(b,d,"",absa.apps.manageCardLimits.onModalClose)};absa.apps.manageCardLimits.refreshContent=function(){var b=bb.selector.query(window.document,absa.apps.manageCardLimits.tabBoxClass);var a=phe.tabBox.getCurrentTabBody(b);var d=bb.selector.query(a,".ap-manageCardLimits-form");if(d){var c=bb.selector.query(d,".ap-cardlimits-content");absa.lazyLoadNode(c,true)}};absa.apps.manageCardLimits.onModalClose=function(c){var a=bb.selector.query(c,".ap-manageLimits-wizard");if(a){var b=phe.wizard.getCurrentStepIndex(a);if(b=="2"){absa.apps.manageCardLimits.refreshContent()}}else{phe.modal.hideModal()}};absa.apps.manageCardLimits.onCardChange=function(a){var d=bb.selector.queryAncestor(a,".ap-manageCardLimits-form");var c=bb.selector.query(d,".ap-cardlimits-content");var b="proxy?pipe=genericWebservice&ws=ProfileWebService&action=getCardATMandPosLimits&combiCardNumber="+phe.select.getValue(a);phe.common.setAttribute(c,"proxyurl",b);absa.lazyLoadNode(c,true,function(){var f=bb.selector.query(d,".ap-cardLimits-change");var e=bb.selector.query(d,".ap-cardlimits-noLimitsExist");if(e){phe.common.hide(f)}else{phe.common.show(f)}})};absa.apps.manageCardLimits.onLimitChange=function(d,b){var c=bb.selector.queryAncestor(d,".ap-cardLimits-form");var a=bb.selector.query(c,b);oNewLimit=phe.textBox.getValue(d);oMaxLimit=phe.hiddenField.getValue(a);if(Number(oNewLimit)>Number(oMaxLimit)){return false}else{return true}};absa.apps.debitCardReplacement=absa.apps.debitCardReplacement||{};absa.apps.debitCardReplacement.onDebitCardTabLoad=function(){if(document.getElementById("debitCardReplacement-debitCards")!=null){displayNormalFooter()}};absa.apps.debitCardReplacement.tabBoxClass;absa.apps.debitCardReplacement.onDebitCardChange=function(e){var o=phe.select.getValue(e);var n=document.getElementById("debitCardReplacement-replacementReasons");var j=document.getElementById("debitCardReplacement-replacementReasons-toolTip");var b=document.getElementById("debitCardReplacement-replacementReasons-specialDescription");var c=document.getElementById("tooltipVariablefield");var h=document.getElementById("debitCardReasonInputId");if(o==""){h.value="";n.disabled=false;n.options[0].selected=true;return}document.getElementById("debitCardReasonid").style.display="";document.getElementById("debitCardProductid").style.display="";var f="<label tooltip='Select' id='debitCardReplacement-replacementReasons-toolTip-label' for='ap-viewCardPin-CardNumber' class='ui-label ap-label-details' offsetx='0' offsety='10'><span class='ui-label--icon'></span></label>";var l=o.split("-");var d=l[1];if(d!="#"){for(var g=0;g<n.options.length;g++){var k=n.options[g].value;var m=k.split("#_#")[0];if(m==d){n.options[g].selected=true;break}}n.disabled=true;var a=d.split("#")[1];j.innerHTML="You have already reported this card as '"+a+"'";b.innerHTML="";h.value=n.options[n.selectedIndex].value}else{n.disabled=false;n.options[0].selected=true;j.innerHTML=f;b.innerHTML="";h.value=""}};absa.apps.debitCardReplacement.onReasonChange=function(a){var f=phe.select.getValue(a);var h=document.getElementById("debitCardReasonInputId");var c=document.getElementById("debitCardReplacement-replacementReasons");var b=c.options[c.selectedIndex].value;var g=f.split("#")[0];var e=document.getElementById("debitCardReplacement-replacementReasons-toolTip-label");var d=document.getElementById("debitCardReplacement-replacementReasons-specialDescriptionLabel");if(f==""){e.setAttribute("tooltip","Select");h.value="";return}e.setAttribute("tooltip",f.split("#_#")[1]);h.value=b};absa.apps.debitCardReplacement.onPreferedBranchChange=function(c){var a=document.getElementById("viewDeliveryAddress-transactionType").value;for(var b=0;b<c._aSuggestDataIndex.length;b++){if(c._aSuggestDataIndex[b].index.toUpperCase()==c.value){branchInfoDetails=c._aSuggestDataIndex[b].item.getAttribute("value");break}}document.getElementById("preferedBranchCodeId").value=branchInfoDetails;var d=document.getElementById("descriptionForpreferedbranch");var f=document.getElementById("descriptionForfaceToFacebranch");var e=branchInfoDetails.split("#")[2];d.innerHTML="";f.innerHTML="";if(a=="B"){d.innerHTML=e}else{if(a=="F"){f.innerHTML=e}}};absa.apps.debitCardReplacement.onCardChange=function(d){var j=bb.selector.queryAncestor(d,".ap-viewDebitCardReplacement-form");var e=bb.selector.query(j,".ap-cardlimits-content");var i=phe.select.getValue(d);if(i==""){var c=document.getElementById("debitCardReplacement-replacementProductType");if(c!=null){c.options[0].selected=true}document.getElementById("CardTypeToHide").innerHTML="";return}else{document.getElementById("app-deliveryAddress-div").style.display="";document.getElementById("deliveryAddressHideShowid").style.display="";var f=i.split("#");var b=f[0];var g=f[1];var h=f[2];var a="proxy?pipe=genericWebservice&ws=ProfileWebService&action=getDebitCardTypes&productCode="+b+"&productDesc="+g+"&productType="+h;phe.common.setAttribute(e,"proxyurl",a);absa.lazyLoadNode(e,true)}};absa.apps.debitCardReplacement.onAddressChange=function(b){document.getElementById("app-cardReplcamentNormalFooter-div").value="none";var e=document.getElementById("app-deliveryAddress-div");var a=phe.select.getValue(b);if(a==""){if(e!=null){e.style.display="none"}displayNormalFooter();return}e.style.display="block";if(e.innerHTML==""){var f=bb.selector.queryAncestor(b,".ap-viewDebitCardReplacement-form");var d=bb.selector.query(f,".ap-contactDetails-content");var c="proxy?pipe=genericWebservice&ws=ProfileWebService&action=getClientContactDetails";phe.common.setAttribute(d,"proxyurl",c);absa.lazyLoadNode(d,true,function(g){setElementsInAddressDiv(a);document.getElementById("faceToFaceDetails-cardReplacementPreferedBranch").value="";document.getElementById("nearestBRanchDetails-cardReplacementPreferedBranch").value="";document.getElementById("descriptionForpreferedbranch").innerHTML="";document.getElementById("descriptionForfaceToFacebranch").innerHTML="";setContactDetailsErrorDiv(a)})}else{setElementsInAddressDiv(a);document.getElementById("faceToFaceDetails-cardReplacementPreferedBranch").value="";document.getElementById("nearestBRanchDetails-cardReplacementPreferedBranch").value="";document.getElementById("descriptionForpreferedbranch").innerHTML="";document.getElementById("descriptionForfaceToFacebranch").innerHTML="";setContactDetailsErrorDiv(a)}};function setContactDetailsErrorDiv(b){var c=document.getElementById("contactDetailsFaceToFace-cellPhone").value;var a=document.getElementById("nearestBRanchContactDetails-cellPhone").value;if(a==""||c==""){displayContactErrorMessage()}else{displayNormalFooter()}}function displayNormalFooter(){document.getElementById("app-cardReplcamentNormalFooter-div").style.display="block";document.getElementById("app-contactError-div").style.display="none"}function displayContactErrorMessage(){document.getElementById("app-cardReplcamentNormalFooter-div").style.display="none";document.getElementById("app-contactError-div").style.display="block"}function setElementsInAddressDiv(b){var c=document.getElementById("nearestBranch-addressDiv");var a=document.getElementById("faceToFace-addressDiv");if(b=="B"){a.style.display="none";c.style.display="block"}else{a.style.display="block";c.style.display="none"}}var absa=window.absa||{};absa.apps=absa.apps||{};absa.apps.manageCardServices=absa.apps.manageCardServices||{};absa.apps.manageCardServices.onCardChange=function(b){var e=bb.selector.queryAncestor(b,".ap-manageCardServices-form");var d=bb.selector.query(e,".ap-manageCardServices-cardOptions");var a=phe.select.getValue(b);var c="proxy?pipe=genericWebservice&ws=ProfileWebService&action=enquirePauseCardAndTravelNotification&cardNumber="+a;phe.common.setAttribute(d,"proxyurl",c);e.reset();phe.select.setValue(b,a);absa.lazyLoadNode(d,true)};absa.apps.manageCardServices.selectRow=function(d){var a=bb.selector.queryAncestor(d,".ap-manageCardServices-table-row");var c=bb.selector.queryAll(a,".ap-manageCardServices-checkBox");if(phe.checkBox.isChecked(d)){for(var b=0;b<c.length;b++){phe.checkBox.setAttribute(c[b],"checked","true")}}else{for(var b=0;b<c.length;b++){phe.checkBox.setAttribute(c[b],"checked","false")}}};absa.apps.manageCardServices.uncheckAllCheckbox=function(g,f){var b=bb.selector.queryAncestor(g,".ap-manageCardServices-table-row");var d=bb.selector.query(b,f);var a=bb.selector.query(b,".ap-manageCardServices-checkBox-selectAll");var e=bb.selector.queryAll(b,".ap-manageCardServices-checkBox");if(phe.checkBox.isChecked(g)){for(var c=0;c<e.length;c++){if(!phe.checkBox.isChecked(e[c])){phe.checkBox.setAttribute(a,"checked","false");break}else{phe.checkBox.setAttribute(a,"checked","true")}}}else{phe.checkBox.setAttribute(a,"checked","false")}};absa.apps.manageCardServices.readCheckboxValues=function(d){var k=bb.selector.queryAncestor(d,".ap-manageCardServices-form");var b=bb.selector.query(k,".ap-cardlimits-content");var t=bb.selector.queryAncestor(d,".ui-tabBody-selected");var f=bb.selector.query(b,".ap-manageCardServices-checkBox-selectAll");var q=bb.selector.query(b,".ap-manageCardServices-localATMWithdrawals");var a=bb.selector.query(b,".ap-manageCardServices-internationalATMWithdrawals");var n=bb.selector.query(b,".ap-manageCardServices-onlinePurchases");var c=bb.selector.query(b,".ap-manageCardServices-localInstoreTx");var g=bb.selector.query(b,".ap-manageCardServices-internationalInstoreTx");var r=bb.selector.query(k,".ap-travelNotification-travelStartDate");var h=bb.selector.query(k,".ap-travelNotification-travelEndDate");var p=phe.datePicker.getValue(r);var o=phe.datePicker.getValue(h);var e=bb.selector.query(k,".ap-travelNotification-modalDiv");var i=bb.selector.query(e,".ap-travelNotification-internatioalTransactionsReminderModal");if(o==""&&p!=""){phe.datePicker.setAttribute(h,"customValidation","return false");absa.form.validate.checkElement(h);return false}if(p==""&&o!=""){phe.datePicker.setAttribute(r,"customValidation","return false");absa.form.validate.checkElement(r);return false}var l=phe.hiddenField.getValue(bb.selector.query(k,".ap-travelStartDateOldValue"));var s=phe.hiddenField.getValue(bb.selector.query(k,".ap-travelEndDateOldValue"));if(l==p&&s==o){phe.datePicker.setAttribute(r,"customValidation","return true");phe.datePicker.setAttribute(h,"customValidation","return true")}else{var m=absa.date.formatDate(new Date());if(p!=""&&p<m){phe.datePicker.setAttribute(r,"customValidation","return false");absa.form.validate.checkElement(r);return false}}var j=absa.date.getDaysDiff(p,o);if(Number(j)<0){phe.datePicker.setAttribute(h,"customValidation","return false");absa.form.validate.checkElement(h);return false}else{if(Number(j)>60){phe.datePicker.setAttribute(h,"customValidation","return false");absa.form.validate.checkElement(h);return false}else{phe.datePicker.setAttribute(h,"customValidation","return true");absa.form.validate.checkElement(h)}}if(p!=""&&o!=""){if(phe.checkBox.isChecked(a)||phe.checkBox.isChecked(g)){phe.modal.showModal(0.5,i,document.body,true)}}if(phe.checkBox.isChecked(q)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-localATMWithdrawalsValue"),"value","Y")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-localATMWithdrawalsValue"),"value","N")}if(phe.checkBox.isChecked(c)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-localInstoreTransactionsValue"),"value","Y")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-localInstoreTransactionsValue"),"value","N")}if(phe.checkBox.isChecked(n)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-onlinePurchasesValue"),"value","Y")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-onlinePurchasesValue"),"value","N")}if(phe.checkBox.isChecked(a)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-internationalATMWithdrawalsValue"),"value","Y")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-internationalATMWithdrawalsValue"),"value","N")}if(phe.checkBox.isChecked(g)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-internationalInstoreTransactionsValue"),"value","Y")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-internationalInstoreTransactionsValue"),"value","N")}if(phe.checkBox.isChecked(f)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-digitalWalletValue"),"value","Y")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-digitalWalletValue"),"value","N")}if(phe.checkBox.isChecked(f)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-pauseAllTransactionsValue"),"value","P")}else{if(!phe.checkBox.isChecked(q)&&!phe.checkBox.isChecked(a)&&!phe.checkBox.isChecked(n)&&!phe.checkBox.isChecked(c)&&!phe.checkBox.isChecked(g)){phe.hiddenField.setAttribute(bb.selector.query(b,".ap-pauseAllTransactionsValue"),"value","D")}else{phe.hiddenField.setAttribute(bb.selector.query(b,".ap-pauseAllTransactionsValue"),"value","N")}}};absa.apps.manageCardServices.onTravelDateChange=function(g){var c=bb.selector.queryAncestor(g,".ap-manageCardServices-travelNotification");var f=bb.selector.query(c,".ap-travelNotification-travelStartDate");var e=bb.selector.query(c,".ap-travelNotification-travelEndDate");var b=phe.datePicker.getValue(f);var d=phe.datePicker.getValue(e);var h=absa.date.getDaysDiff(b,d);var a=absa.date.formatDate(new Date());if(Number(h)<0){phe.datePicker.setAttribute(e,"customValidation","return false");absa.form.validate.checkElement(e);return false}else{if(b!=""&&b<a){phe.datePicker.setAttribute(f,"customValidation","return false");absa.form.validate.checkElement(f);return false}else{phe.datePicker.setAttribute(g,"customValidation","return true");absa.form.validate.checkElement(g)}}};absa.apps.manageCardServices.onRemoveButtonClick=function(d){var a=bb.selector.queryAncestor(d,".ap-manageCardServices-travelNotification");var c=bb.selector.query(a,".ap-travelNotification-travelStartDate");var b=bb.selector.query(a,".ap-travelNotification-travelEndDate");phe.datePicker.setValue(c,"");phe.datePicker.setValue(b,"");phe.datePicker.setAttribute(c,"disabled","true");phe.datePicker.setAttribute(b,"disabled","true")};absa.apps.manageCardServices.onResetButtonClick=function(f){var g=bb.selector.queryAncestor(f,".ap-manageCardServices-form");var a=bb.selector.query(g,".ap-manageCardServices-travelNotification");var e=bb.selector.query(a,".ap-travelNotification-travelStartDate");var d=bb.selector.query(a,".ap-travelNotification-travelEndDate");phe.datePicker.setAttribute(e,"disabled","false");phe.datePicker.setAttribute(d,"disabled","false");var c=bb.selector.query(g,".ap-manageCardServices-CardNumber-select");var b=phe.select.getValue(c);g.reset();phe.select.setValue(c,b)};