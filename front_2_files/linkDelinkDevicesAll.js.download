absa.apps.linkDelinkDevices=absa.apps.linkDelinkDevices||{};absa.apps.linkDelinkDevices.global=absa.apps.linkDelinkDevices.global||{};absa.apps.linkDelinkDevices.global.tableRow=null;absa.apps.linkDelinkDevices.onLinkDeviceClick=function(b,c,a){absa.apps.linkDelinkDevices.clearErrorMessages(b);absa.modal.loadModal(c,a,null,absa.apps.linkDelinkDevices.checkLinkDeviceWizardStep)};absa.apps.linkDelinkDevices.checkLinkDeviceWizardStep=function(c){var a=bb.selector.query(c,".ap-linkDevice-modal");var b=phe.wizard.getCurrentStepIndex(a);if(b=="2"){var d=bb.selector.query(absa.gadgets.linkDelinkDevices.gadget.body,".ap-linkDelinkDevices-tabBody");absa.lazyLoadNode(d,true)}};absa.apps.linkDelinkDevices.onDoneButtonClick=function(a){absa.apps.linkDelinkDevices.closeModalandReloadTable()};absa.apps.linkDelinkDevices.onChangeNicknameButtonClick=function(e){var a=bb.selector.queryAncestor(e,".ap-linkDelinkDevice-table");var c=bb.selector.queryAncestor(e,".ap-linkDelinkDevice-tableRow");var b=bb.selector.query(c,".ap-linkDelinkDevice-NicknameReadOnly");var d=bb.selector.query(c,".ap-linkDelinkDevice-NicknameTextBox");var g=bb.selector.query(c,".ap-linkDelinkDevice-saveButton");var f=bb.selector.query(c,".ap-linkDelinkDevice-cancelButton");absa.apps.linkDelinkDevices.clearErrorMessages(e);phe.common.hide(b);phe.textBox.setValue(d,phe.inputReadOnlyText.getValue(b));phe.common.show(d);phe.common.show(g);phe.common.show(f)};absa.apps.linkDelinkDevices.onSaveButtonClick=function(i){var n=bb.selector.queryAncestor(i,".ap-linkDelinkDevice-tableRow");var l=bb.selector.queryAncestor(i,".ap-linkDelinkDevices-tabBody");var c=bb.selector.queryAncestor(i,".ap-viewLinkDelinkDevices");var k=bb.selector.queryAncestor(i,".ui-form");var j=bb.selector.query(k,".ap-linkDelinkDevice-table");var m=bb.selector.query(j,".ui-table--scrollContainer");var a=bb.selector.query(n,".ap-linkDelinkDevice-NicknameTextBox");var e=bb.selector.query(n,".ap-linkDelinkDevice-ManufacturerHidden");var b=bb.selector.query(n,".ap-linkDelinkDevice-ModelHidden");var h=bb.selector.query(n,".ap-linkDelinkDevice-IMEISerialNumberHidden");absa.apps.linkDelinkDevices.clearErrorMessages(i);var f="&deviceNo=1&nickname="+encodeURIComponent(phe.textBox.getValue(a))+"&manufacturer="+encodeURIComponent(phe.hiddenField.getValue(e))+"&model="+encodeURIComponent(phe.hiddenField.getValue(b))+"&IMEISerialNumber="+encodeURIComponent(phe.hiddenField.getValue(h))+"&operation=C";var g={};g[gadgets.io.RequestParameters.METHOD]=gadgets.io.MethodType.POST;g[gadgets.io.RequestParameters.POST_DATA]=f;var d="proxy?pipe=genericWebservice&ws=DeviceManagementWebService&action=updateDevice";if(absa.form.validate(k)){phe.loadingMessage.showLoadingMessage(l);absa.io.makeRequest(d,function(p){phe.loadingMessage.hideLoadingMessage(l);if(!p.errors.length){var o=bb.html.createElementFromString(p.text);var q=bb.selector.query(o,".ap-changeDeviceNickname-error");if(q){c.appendChild(o)}else{phe.tabBody.reload(l)}}else{phe.form.displayIOErrorMessage(k,true)}},g)}};absa.apps.linkDelinkDevices.onCancelButtonClick=function(e){var a=bb.selector.queryAncestor(e,".ap-linkDelinkDevice-table");var c=bb.selector.queryAncestor(e,".ap-linkDelinkDevice-tableRow");var b=bb.selector.query(c,".ap-linkDelinkDevice-NicknameReadOnly");var d=bb.selector.query(c,".ap-linkDelinkDevice-NicknameTextBox");var g=bb.selector.query(c,".ap-linkDelinkDevice-saveButton");var f=bb.selector.query(c,".ap-linkDelinkDevice-cancelButton");absa.apps.linkDelinkDevices.clearErrorMessages(e);phe.common.hide(d);phe.common.hide(g);phe.common.hide(f);phe.common.show(b)};absa.apps.linkDelinkDevices.onDelinkButtonClick=function(b,c,a){absa.apps.linkDelinkDevices.clearErrorMessages(b);absa.modal.loadModal(c,a,null,absa.apps.linkDelinkDevices.checkDelinkDeviceWizardStep)};absa.apps.linkDelinkDevices.checkDelinkDeviceWizardStep=function(c){var a=bb.selector.query(c,".ap-delinkDevice-modal");var b=phe.wizard.getCurrentStepIndex(a);if(b=="1"){var d=bb.selector.query(absa.gadgets.linkDelinkDevices.gadget.body,".ap-linkDelinkDevices-tabBody");absa.lazyLoadNode(d,true)}};absa.apps.linkDelinkDevices.onRejectDeviceButtonClick=function(d){var c=bb.selector.queryAncestor(d,".ap-viewLinkDelinkDevices");var b=bb.selector.queryAncestor(d,".ap-linkDelinkDevice-tableRow");var a=bb.selector.query(c,".ap-linkDelinkDevice-rejectDeviceModal");absa.apps.linkDelinkDevices.clearErrorMessages(d);absa.apps.linkDelinkDevices.global.tableRow=b;phe.modal.showModal(0.5,a,c,true)};absa.apps.linkDelinkDevices.onRejectConfirmButtonClick=function(i){var c=bb.selector.queryAncestor(i,".ap-viewLinkDelinkDevices");var l=bb.selector.query(absa.gadgets.linkDelinkDevices.gadget.body,".ap-linkDelinkDevices-tabBody");var k=bb.selector.query(c,".ui-form");var j=bb.selector.query(k,".ap-linkDelinkDevice-table");var m=absa.apps.linkDelinkDevices.global.tableRow;var b=bb.selector.query(m,".ap-linkDelinkDevice-NicknameReadOnly");var h=bb.selector.query(m,".ap-linkDelinkDevice-ManufacturerHidden");var a=bb.selector.query(m,".ap-linkDelinkDevice-ModelHidden");var g=bb.selector.query(m,".ap-linkDelinkDevice-IMEISerialNumberHidden");var e="&deviceNo=1&nickname="+encodeURIComponent(phe.inputReadOnlyText.getValue(b))+"&manufacturer="+encodeURIComponent(phe.hiddenField.getValue(h))+"&model="+encodeURIComponent(phe.hiddenField.getValue(a))+"&IMEISerialNumber="+encodeURIComponent(phe.hiddenField.getValue(g))+"&operation=D";var f={};f[gadgets.io.RequestParameters.METHOD]=gadgets.io.MethodType.POST;f[gadgets.io.RequestParameters.POST_DATA]=e;var d="proxy?pipe=genericWebservice&ws=PortfolioWebService&action=maintainDeLinkDevice";if(absa.form.validate(k)){phe.loadingMessage.showLoadingMessage(l);absa.io.makeRequest(d,function(o){phe.loadingMessage.hideLoadingMessage(l);if(!o.errors.length){var n=bb.html.createElementFromString(o.text);var p=bb.selector.query(n,".ap-maintainRejectDevice-error");if(p){c.appendChild(n)}else{phe.tabBody.reload(l)}}else{phe.form.displayIOErrorMessage(k,true)}},f)}phe.modal.hideModal()};absa.apps.linkDelinkDevices.clearErrorMessages=function(c){var b=bb.selector.queryAncestor(c,".ap-viewLinkDelinkDevices");var a=bb.selector.query(b,".ap-linkDelinkDevice-rejectDeviceForm");var d=bb.selector.query(b,".ap-linkDelinkDevice-updateDeviceForm");if(a!=null){b.removeChild((a.parentNode).parentNode)}if(d!=null){b.removeChild((d.parentNode).parentNode)}};absa.apps.linkDelinkDevices.setNewGraph=function(e){var a=phe.radioGroup.getValue(e);var f=bb.selector.queryAncestor(e,".ui-form");var c=bb.selector.queryAncestor(f,".ap-graphSlidermainContainer");var d="proxy?pipe=genericEmptyResponse&xslFile=abcap/GraphExample/graphExample&mode=graphchange&graphValue="+a;var b=bb.selector.query(f,".ap-graphContainer");phe.common.setAttribute(b,"proxyurl",d);absa.lazyLoadNode(b,true)};absa.apps.linkDelinkDevices.onMakeSurecheck2DeviceClick=function(b,c,a){absa.apps.linkDelinkDevices.clearErrorMessages(b);absa.modal.loadModal(c,a,absa.apps.linkDelinkDevices.onModalLoad)};absa.apps.linkDelinkDevices.onLinkNewDeviceClick=function(b,c,a){absa.modal.loadModal(c,a,absa.apps.linkDelinkDevices.onModalLoad,absa.apps.linkDelinkDevices.closeModalandReloadTable,absa.LANG,"570",true)};absa.apps.linkDelinkDevices.onModalLoad=function(){var b=bb.selector.query(window.document,".ap-n2fa-getSureCheck-form-step1");if(!b){b=bb.selector.query(window.document,".ap-n2fa-makeSureCheck-form-step1")}var a=bb.selector.queryAncestor(b,".ui-modalBody");a.removeAttribute("proxyurl")};absa.apps.linkDelinkDevices.closeModalandReloadTable=function(){phe.modal.hideModal();var a=bb.selector.query(absa.gadgets.linkDelinkDevices.gadget.body,".ap-linkDelinkDevices-tabBody");absa.lazyLoadNode(a,true)};