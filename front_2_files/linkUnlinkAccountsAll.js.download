var absa=window.absa||{};absa.apps=absa.apps||{};absa.apps.linkUnlink=absa.apps.linkUnlink||{};absa.apps.linkUnlink.globals=absa.apps.linkUnlink.globals||{};absa.apps.linkUnlink.globals.oRoot=null;absa.apps.linkUnlink.globals.oForm1=null;absa.apps.linkUnlink.globals.oTblUnlinkedAcc=null;absa.apps.linkUnlink.globals.oTblLinkedAcc=null;absa.apps.linkUnlink.globals.oLinkedAccTBody=null;absa.apps.linkUnlink.globals.oUnLinkedAccTBody=null;absa.apps.linkUnlink.theList=[];absa.apps.linkUnlink.resetMyArray=function(){absa.apps.linkUnlink.theList=[]};absa.apps.linkUnlink.resetGlobalVariables=function(){absa.apps.linkUnlink.globals.oRoot=null;absa.apps.linkUnlink.globals.oForm1=null;absa.apps.linkUnlink.globals.oTblUnlinkedAcc=null;absa.apps.linkUnlink.globals.oTblLinkedAcc=null;absa.apps.linkUnlink.globals.oLinkedAccTBody=null;absa.apps.linkUnlink.globals.oUnLinkedAccTBody=null;absa.apps.linkUnlink.theList=[]};absa.apps.linkUnlink.refreshAccountsTab=function(a){absa.apps.linkUnlink.resetMyArray();phe.tabBox.reloadTab(a)};absa.apps.linkUnlink.linkAccount=function(g,c,m,j){absa.apps.linkUnlink.linkUnlinkAccount(g,c,m,"link",j);if(absa.apps.linkUnlink.globals.oRoot==null){absa.apps.linkUnlink.globals.oRoot=bb.selector.queryAncestor(g,".ap-linkUnlink-root")}if(absa.apps.linkUnlink.globals.oRoot!=null){if(absa.apps.linkUnlink.globals.oTblLinkedAcc==null){absa.apps.linkUnlink.globals.oTblLinkedAcc=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-linkedAccounts")}if(absa.apps.linkUnlink.globals.oTblUnlinkedAcc==null){absa.apps.linkUnlink.globals.oTblUnlinkedAcc=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-unlinkedAccounts")}var b=bb.selector.queryAll(absa.apps.linkUnlink.globals.oTblLinkedAcc,".ui-message");for(var k=0;k<b.length;k++){var a=bb.selector.queryAncestor(b[k],".ui-tableBodyRow");phe.common.hide(a);phe.common.hide(b[k])}var n=true;for(var l=0;l<absa.apps.linkUnlink.theList.length;l=l+4){var e=absa.apps.linkUnlink.theList[l];var d=absa.apps.linkUnlink.theList[(l+1)];var i=absa.apps.linkUnlink.theList[(l+2)];var h=absa.apps.linkUnlink.theList[(l+3)];if(d==c){n=false;absa.apps.linkUnlink.theList.splice(l,1);absa.apps.linkUnlink.theList.splice(l,1);absa.apps.linkUnlink.theList.splice(l,1);absa.apps.linkUnlink.theList.splice(l,1);break}}if(n){var f=absa.apps.linkUnlink.theList.length;absa.apps.linkUnlink.theList[f]="link";absa.apps.linkUnlink.theList[(f+1)]=c;if(m.indexOf(" - ")>-1){absa.apps.linkUnlink.theList[(f+2)]=m.substring(0,m.indexOf(" - "))}else{absa.apps.linkUnlink.theList[(f+2)]=m}absa.apps.linkUnlink.theList[(f+3)]=j}}};absa.apps.linkUnlink.unLinkAccount=function(g,c,m,j){absa.apps.linkUnlink.linkUnlinkAccount(g,c,m,"unlink",j);if(absa.apps.linkUnlink.globals.oRoot==null){absa.apps.linkUnlink.globals.oRoot=bb.selector.queryAncestor(g,".ap-linkUnlink-root")}if(absa.apps.linkUnlink.globals.oRoot!=null){if(absa.apps.linkUnlink.globals.oTblUnlinkedAcc==null){absa.apps.linkUnlink.globals.oTblUnlinkedAcc=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-unlinkedAccounts")}if(absa.apps.linkUnlink.globals.oTblLinkedAcc==null){absa.apps.linkUnlink.globals.oTblLinkedAcc=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-linkedAccounts")}var b=bb.selector.queryAll(absa.apps.linkUnlink.globals.oTblUnlinkedAcc,".ui-message");for(var k=0;k<b.length;k++){var a=bb.selector.queryAncestor(b[k],".ui-tableBodyRow");phe.common.hide(a);phe.common.hide(b[k])}var n=true;for(var l=0;l<absa.apps.linkUnlink.theList.length;l=l+4){var e=absa.apps.linkUnlink.theList[l];var d=absa.apps.linkUnlink.theList[(l+1)];var i=absa.apps.linkUnlink.theList[(l+2)];var h=absa.apps.linkUnlink.theList[(l+3)];if(d==c){n=false;absa.apps.linkUnlink.theList.splice(l,1);absa.apps.linkUnlink.theList.splice(l,1);absa.apps.linkUnlink.theList.splice(l,1);absa.apps.linkUnlink.theList.splice(l,1);break}}if(n){var f=absa.apps.linkUnlink.theList.length;absa.apps.linkUnlink.theList[f]="unlink";absa.apps.linkUnlink.theList[(f+1)]=c;if(m.indexOf(" - ")>-1){absa.apps.linkUnlink.theList[(f+2)]=m.substring(0,m.indexOf(" - "))}else{absa.apps.linkUnlink.theList[(f+2)]=m}absa.apps.linkUnlink.theList[(f+3)]=j}}};absa.apps.linkUnlink.linkUnlinkAccount=function(h,k,b,p,o){var c=h.parentNode.parentNode.parentNode;if(c==null){c=bb.selector.queryAncestor(h,".ui-tableBodyRow")}if(absa.apps.linkUnlink.globals.oForm1==null){absa.apps.linkUnlink.globals.oForm1=bb.selector.queryAncestor(c,".ap-linkUnlink-form1")}var j=absa.apps.linkUnlink.globals.oForm1;if(absa.apps.linkUnlink.globals.oLinkedAccTBody==null){absa.apps.linkUnlink.globals.oLinkedAccTBody=bb.selector.query(absa.apps.linkUnlink.globals.oForm1,".ap-linkUnlink-linkedAccounts .ui-tableBodyTBody")}if(absa.apps.linkUnlink.globals.oUnLinkedAccTBody==null){absa.apps.linkUnlink.globals.oUnLinkedAccTBody=bb.selector.query(absa.apps.linkUnlink.globals.oForm1,".ap-linkUnlink-unlinkedAccounts .ui-tableBodyTBody")}var r=document.createElement("input");r.name="accNoToLink";r.id="accNoToLink"+k;r.setAttribute("class","ipacc");r.style.display="none";var a=document.createElement("input");a.name="accNameToLink";a.id="accNameToLink"+k;a.setAttribute("class","ipacc");a.style.display="none";var s=document.createElement("input");s.name="accTypeNameToLink";s.id="accTypeNameToLink"+k;s.setAttribute("class","ipacc");s.style.display="none";var q=document.createElement("input");q.name="accNoToUnlink";q.id="accNoToUnlink"+k;q.setAttribute("class","ipacc");q.style.display="none";var f=document.createElement("input");f.name="accNameToUnlink";f.id="accNameToUnlink"+k;f.setAttribute("class","ipacc");f.style.display="none";var e=document.createElement("input");e.name="accTypeNameToUnlink";e.id="accTypeNameToUnlink"+k;e.setAttribute("class","ipacc");e.style.display="none";if(p=="link"){c.setAttribute("accountno",""+k);h.className="ap-icon ap-icon-removeBen";h.onclick=function(){absa.apps.linkUnlink.unLinkAccount(h,k,b,o)};if(o=="cia"){var g=bb.selector.query(j,"#ap-linkUnlink-unlinkTooltipTextForCia").value}else{var g=bb.selector.query(j,"#ap-linkUnlink-unlinkTooltipText").value}h.setAttribute("tooltip",g);var n=bb.selector.queryAll(c,"td");c.removeChild(n[0]);c.removeChild(n[1]);c.removeChild(n[2]);c.appendChild(n[1]);c.appendChild(n[0]);c.appendChild(n[2]);bb.html.replaceClass(n[1],"ui-tableBodyCell ui-table-last-Column ap-common-alignLeft","ui-tableBodyCell ap-common-alignLeft");bb.html.replaceClass(n[0],"ui-tableBodyCell ","ui-tableBodyCell ui-table-last-Column");var d=bb.selector.query(n[0],".ui-tableBodyCellContent");bb.html.setStyle(d,"width","339px");absa.apps.linkUnlink.globals.oLinkedAccTBody.appendChild(c);absa.initializeNewContent(c);var m=bb.selector.query(j,"#accNoToUnlink"+k);var i=bb.selector.query(j,"#accNameToUnlink"+k);if(m!=null){j.removeChild(m);if(i!=null){j.removeChild(i)}}else{r.value=k;j.appendChild(r);absa.initializeNewContent(r);a.value=b;j.appendChild(a);absa.initializeNewContent(a);s.value=o;j.appendChild(s);absa.initializeNewContent(s)}}else{c.setAttribute("accountno",""+k);h.className="ap-icon ap-icon-addBen";h.onclick=function(){absa.apps.linkUnlink.linkAccount(h,k,b,o)};if(o=="cia"){var l=bb.selector.query(j,"#ap-linkUnlink-linkTooltipTextForCia").value}else{var l=bb.selector.query(j,"#ap-linkUnlink-linkTooltipText").value}h.setAttribute("tooltip",l);var n=bb.selector.queryAll(c,"td");n=bb.selector.queryAll(c,"td");c.removeChild(n[0]);c.removeChild(n[1]);c.removeChild(n[2]);c.appendChild(n[1]);c.appendChild(n[0]);c.appendChild(n[2]);bb.html.replaceClass(n[1],"ui-tableBodyCell ui-table-last-Column","ui-tableBodyCell");bb.html.replaceClass(n[0],"ui-tableBodyCell ap-common-alignLeft","ui-tableBodyCell");bb.html.setStyle(n[1].childNodes[0],"width","347px");absa.apps.linkUnlink.globals.oUnLinkedAccTBody.appendChild(c);absa.initializeNewContent(c);var m=bb.selector.query(j,"#accNoToLink"+k);var i=bb.selector.query(j,"#accNameToLink"+k);if(m!=null){j.removeChild(m);if(i!=null){j.removeChild(i)}}else{q.value=k;j.appendChild(q);absa.initializeNewContent(q);f.value=b;j.appendChild(f);absa.initializeNewContent(f);e.value=o;j.appendChild(e);absa.initializeNewContent(e)}}};absa.apps.linkUnlink.beforeSubmitAccountsStep1=function(b){var c=bb.selector.queryAncestor(b,".ap-linkUnlink-form1");var a=bb.selector.query(c,".ap-linkUnlink-msgNothingChanged");if(absa.apps.linkUnlink.theList.length==0){phe.common.show(a);bb.command.scrollTo(a);return false}else{phe.common.hide(a);absa.form.validateAndSubmit(c)}};absa.apps.linkUnlink.validateRetailAccountCallback=function(p,f){var h=bb.html.createElementFromString(f.text);if(f.status==200){var e=[];var j=bb.selector.queryAll(h,".ap-linkUnlink-resultMessages");for(var g=0;g<j.length;g++){var k=j[g];var s=k.getAttribute("data-accountno");var a=k.getAttribute("data-accountname");var d=k.getAttribute("data-accounttype");var c=k.getAttribute("data-tobe");var m=k.innerHTML;var n=false;for(var i=0;i<absa.apps.linkUnlink.theList.length;i=i+4){var t=absa.apps.linkUnlink.theList[i];var q=absa.apps.linkUnlink.theList[(i+1)];var b=absa.apps.linkUnlink.theList[(i+2)];var l=absa.apps.linkUnlink.theList[(i+3)];if(l=="cia"&&d=="cia"){if(q!=s){n=true}else{n=false;break}}}if(n){var o=absa.apps.linkUnlink.theList.length;absa.apps.linkUnlink.theList[o]=c;absa.apps.linkUnlink.theList[(o+1)]=s;absa.apps.linkUnlink.theList[(o+2)]=a;absa.apps.linkUnlink.theList[(o+3)]="cia"}if(c=="linked"){if((m.indexOf("Auth")>-1)|(m.indexOf("Magti")>-1)){}else{for(var i=0;i<absa.apps.linkUnlink.theList.length;i=i+4){var t=absa.apps.linkUnlink.theList[i];var q=absa.apps.linkUnlink.theList[(i+1)];var b=absa.apps.linkUnlink.theList[(i+2)];var l=absa.apps.linkUnlink.theList[(i+3)];if(s==q){if(l.toLowerCase().indexOf("unittrust")>-1){absa.index.addAccountGadget("999999999","UnitTrust",l,false)}else{absa.index.addAccountGadget(q,b,l)}}}}}else{if((m.indexOf("Auth")>-1)|(m.indexOf("Magti")>-1)){}else{e[e.length]=s}}}absa.form.wizardBridge.handleResponse(p,f);if(typeof e!="undefined"){if(e.length>0){for(var g=0;g<e.length;g++){var r=e[g];for(var i=0;i<absa.apps.linkUnlink.theList.length;i=i+4){var t=absa.apps.linkUnlink.theList[i];var q=absa.apps.linkUnlink.theList[(i+1)];var b=absa.apps.linkUnlink.theList[(i+2)];var l=absa.apps.linkUnlink.theList[(i+3)];if(r==q){if(l.toLowerCase().indexOf("unittrust")>-1){absa.apps.linkUnlink.removeAccountGadgetOSTAIMSUNITTRUST("unittrust",l)}else{absa.apps.linkUnlink.removeAccountGadget(q,l);absa.index.accountsBalances[e[g]]=0;absa.index.savingsAccountsBalances[e[g]]=0}}}}}}setTimeout(function(){absa.util.observer.publish("load-balances","")},2000);setTimeout(function(){absa.util.observer.publish("load-saveinvest-balances",{})},2000);absa.apps.linkUnlink.resetMyArray()}};absa.apps.linkUnlink.removeAccountGadgetOSTAIMSUNITTRUST=function(d,e){var b="";var a="";var c="";if(d.toLowerCase()=="ost"){b="77777777";a=e;c="proxy?pipe=genericWebservice&ws=SecurityWebService&action=getUserPrincipal&view=accounts&accountNo="+b+"&mode=linkunlink"}else{if(d.toLowerCase()=="aims"){b="2222222";a=e;c="proxy?pipe=genericWebservice&ws=SecurityWebService&action=getUserPrincipal&view=accounts&accountNo="+b+"&mode=linkunlink"}else{b="999999999";a=e;c="proxy?pipe=genericWebservice&ws=SecurityWebService&action=getUserPrincipal&view=accounts&accountNo="+b+"&mode=linkunlinkUnitTrust"}}absa.io.makeRequest(c,function(h){var l=bb.html.createElementFromString(h.text);if(a.toLowerCase().indexOf("unittrust")>-1){var g=l.getAttribute("unittrustcount");if(Number(g)<1){absa.index.removeAccountGadget(b,a)}}else{var n=l.getAttribute("accId");var f=l.getAttribute("accName");var j=l.getAttribute("accNo");var k=l.getAttribute("accType");var i=l.getAttribute("accAllowPayment");var m=l.getAttribute("accPowerOfAttorney");if(n==""&j==""){absa.index.removeAccountGadget(b,a)}else{}}})};absa.apps.linkUnlink.removeAccountGadget=function(d,c){if(!absa.index.removeAccountGadget(d,c)){var b=bb.selector.queryAll(document.body,".ap-linkUnlink-msgAccountsUnlinkedWillNotBeDisplayedOnNextLogon");for(var a=0;a<b.length;a++){phe.common.show(b[a])}}else{absa.index.refreshUpdaters(false)}};absa.apps.linkUnlink.validateOSTAccountCallback=function(i,a){absa.index.loadContainerGadgets();if(absa.apps.linkUnlink.globals.oRoot==null){absa.apps.linkUnlink.globals.oRoot=bb.selector.queryAncestor(i,".ap-linkUnlink-root")}var j=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-ost-msgGenericContainer");var h=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-ost-accounts");var k=bb.html.createElementFromString(a.text);if(a.status==200){phe.form.displayErrorMessage(i,false);phe.common.hide(j);var g=bb.selector.query(i,".ap-linkUnlink-ost-username");var d=bb.selector.query(i,".ap-linkUnlink-ost-password");phe.textBox.setValue(g,"");phe.textBox.setValue(d,"");var e=bb.selector.query(k,".ui-message-success");var f=bb.selector.query(k,".ui-message-error");var c=bb.selector.query(k,".ui-message-validation");var b=bb.selector.query(k,".ui-message-warning");j.innerHTML=a.text;if(f||c||b){phe.form.displayErrorMessage(i,false);phe.common.show(j)}else{if(e){phe.form.displayErrorMessage(i,false);phe.common.show(j);phe.table.reload(h);absa.index.addAccountGadget("77777777","Ost","ost",true)}}}else{phe.form.displayErrorMessage(i,true);phe.common.hide(j)}};absa.apps.linkUnlink.validateAIMSAccountCallback=function(i,a){absa.index.loadContainerGadgets();if(absa.apps.linkUnlink.globals.oRoot==null){absa.apps.linkUnlink.globals.oRoot=bb.selector.queryAncestor(i,".ap-linkUnlink-root")}var j=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-aims-msgGenericContainer");var h=bb.selector.query(absa.apps.linkUnlink.globals.oRoot,".ap-linkUnlink-aims-accounts");var k=bb.html.createElementFromString(a.text);if(a.status==200){phe.form.displayErrorMessage(i,false);phe.common.hide(j);var g=bb.selector.query(i,".ap-linkUnlink-aims-username");var d=bb.selector.query(i,".ap-linkUnlink-aims-password");phe.textBox.setValue(g,"");phe.textBox.setValue(d,"");var e=bb.selector.query(k,".ui-message-success");var f=bb.selector.query(k,".ui-message-error");var c=bb.selector.query(k,".ui-message-validation");var b=bb.selector.query(k,".ui-message-warning");j.innerHTML=a.text;if(f||c||b){phe.form.displayErrorMessage(i,false);phe.common.show(j)}else{if(e){phe.form.displayErrorMessage(i,false);phe.common.show(j);phe.table.reload(h);absa.index.addAccountGadget("2222222","Aims","aims",true)}}}else{phe.form.displayErrorMessage(i,true);phe.common.hide(j)}};absa.apps.linkUnlink.validateOSTAccountRemoveCallback=function(g,a){var f=bb.selector.query(g,".ap-linkUnlink-ost-accounts");var h=bb.selector.query(g,".ap-linkUnlink-ost-msgGenericContainer");var i=bb.html.createElementFromString(a.text);if(a.status==200){h.innerHTML=a.text;phe.form.displayErrorMessage(g,false);phe.common.show(h);var d=bb.selector.query(i,".ui-message-success");var e=bb.selector.query(i,".ui-message-error");var c=bb.selector.query(i,".ui-message-validation");var b=bb.selector.query(i,".ui-message-warning");if(e|c|b){}else{if(d){phe.table.reload(f);setTimeout('absa.apps.linkUnlink.removeAccountGadgetOSTAIMSUNITTRUST("ost","onlineShareTrading")',"1000")}}}else{phe.form.displayErrorMessage(g,true);phe.common.hide(h)}};absa.apps.linkUnlink.validateAIMSAccountRemoveCallback=function(g,a){var f=bb.selector.query(g,".ap-linkUnlink-aims-accounts");var h=bb.selector.query(g,".ap-linkUnlink-aims-msgGenericContainer");var i=bb.html.createElementFromString(a.text);if(a.status==200){h.innerHTML=a.text;phe.form.displayErrorMessage(g,false);phe.common.show(h);var d=bb.selector.query(i,".ui-message-success");var e=bb.selector.query(i,".ui-message-error");var c=bb.selector.query(i,".ui-message-validation");var b=bb.selector.query(i,".ui-message-warning");if(e||c||b){}else{if(d){phe.table.reload(f);setTimeout('absa.apps.linkUnlink.removeAccountGadgetOSTAIMSUNITTRUST("aims","aims")',"1000")}}}else{phe.form.displayErrorMessage(g,true);phe.common.hide(h)}};absa.apps.linkUnlink.unlinkAIMSAccount=function(c,b){var d=bb.selector.queryAncestor(c,".ap-linkUnlink-aims-unlinkForm");var a=bb.selector.query(d,".ap-linkUnlink-aims-unlinkUsername");phe.hiddenField.setValue(a,b);absa.form.validateAndSubmit(d)};absa.apps.linkUnlink.unlinkOSTAccount=function(c,b){var d=bb.selector.queryAncestor(c,".ap-linkUnlink-ost-unlinkForm");var a=bb.selector.query(d,".ap-linkUnlink-ost-unlinkUsername");phe.hiddenField.setValue(a,b);absa.form.validateAndSubmit(d)};absa.apps.linkUnlink.startAgain=function(b){var a=bb.selector.queryAncestor(b,".ap-linkUnlink-tabBox");var d=phe.tabBox.getCurrentTabBody(a);var c=phe.tabBox.getAttribute(d,"proxyurl");absa.apps.linkUnlink.resetGlobalVariables();phe.tabBox.setAttribute(d,"proxyurl",c);absa.lazyLoadNode(d,true)};var absa=window.absa||{};absa.apps=absa.apps||{};absa.apps.linkUnlinkPolicies={};absa.apps.linkUnlinkPolicies.globals=absa.apps.linkUnlinkPolicies.globals||{};absa.apps.linkUnlinkPolicies.globals.oRoot=null;absa.apps.linkUnlinkPolicies.theList=[];absa.apps.linkUnlinkPolicies.resetMyArray=function(){absa.apps.linkUnlinkPolicies.theList=[]};absa.apps.linkUnlinkPolicies.refreshInsuranceTab=function(a){absa.apps.linkUnlinkPolicies.resetMyArray();phe.tabBox.reloadTab(a)};absa.apps.linkUnlinkPolicies.linkPolicy=function(g,h,i,c){absa.apps.linkUnlinkPolicies.linkUnlinkPolicy(g,h,i,"link",c);var k=true;for(var j=0;j<absa.apps.linkUnlinkPolicies.theList.length;j=j+4){var d=absa.apps.linkUnlinkPolicies.theList[j];var a=absa.apps.linkUnlinkPolicies.theList[(j+1)];var f=absa.apps.linkUnlinkPolicies.theList[(j+2)];var b=absa.apps.linkUnlinkPolicies.theList[(j+3)];if(a==h){k=false;absa.apps.linkUnlinkPolicies.theList.splice(j,1);absa.apps.linkUnlinkPolicies.theList.splice(j,1);absa.apps.linkUnlinkPolicies.theList.splice(j,1);absa.apps.linkUnlinkPolicies.theList.splice(j,1)}}if(k){var e=absa.apps.linkUnlinkPolicies.theList.length;absa.apps.linkUnlinkPolicies.theList[e]="link";absa.apps.linkUnlinkPolicies.theList[(e+1)]=h;absa.apps.linkUnlinkPolicies.theList[(e+2)]=i;absa.apps.linkUnlinkPolicies.theList[(e+3)]=c}};absa.apps.linkUnlinkPolicies.linkUnlinkPolicy=function(l,b,g,t,o){var c=bb.selector.queryAncestor(l,".ui-tableBodyRow");var n=bb.selector.queryAncestor(c,".ap-linkUnlink-form1");var d=bb.selector.queryAncestor(l,"div");var p=bb.selector.query(n,".ap-linkUnlink-linkedAccounts .ui-tableBodyTBody");var j=bb.selector.query(n,".ap-linkUnlink-unlinkedAccounts .ui-tableBodyTBody");var v=document.createElement("input");v.name="policyNoToLink";v.id="policyNoToLink"+b;v.setAttribute("class","ipacc");v.style.display="none";var a=document.createElement("input");a.name="policyNameToLink";a.id="policyNameToLink"+b;a.setAttribute("class","ipacc");a.style.display="none";var w=document.createElement("input");w.name="policyTypeToLink";w.id="policyTypeToLink"+b;w.setAttribute("class","ipacc");w.style.display="none";var u=document.createElement("input");u.name="policyNoToUnlink";u.id="policyNoToUnlink"+b;u.setAttribute("class","ipacc");u.style.display="none";var h=document.createElement("input");h.name="policyNameToUnlink";h.id="policyNameToUnlink"+b;h.setAttribute("class","ipacc");h.style.display="none";var f=document.createElement("input");f.name="policyTypeToUnlink";f.id="policyTypeToUnlink"+b;f.setAttribute("class","ipacc");f.style.display="none";if(t=="link"){c.setAttribute("accountno",""+b);l.className="ap-icon ap-icon-removeBen";l.onclick=function(){absa.apps.linkUnlinkPolicies.unLinkPolicy(l,b,g,o)};var i=bb.selector.query(n,"#ap-linkUnlink-unlinkTooltipText").value;l.setAttribute("tooltip",i);var s=bb.selector.queryAll(c,"td");c.removeChild(s[0]);c.removeChild(s[1]);c.removeChild(s[2]);c.appendChild(s[1]);c.appendChild(s[0]);c.appendChild(s[2]);bb.html.replaceClass(s[1],"ui-tableBodyCell ui-table-last-Column ap-common-alignLeft","ui-tableBodyCell ap-common-alignLeft");bb.html.replaceClass(s[0],"ui-tableBodyCell ","ui-tableBodyCell ui-table-last-Column");var e=bb.selector.query(s[0],".ui-tableBodyCellContent");bb.html.setStyle(e,"width","339px");p.appendChild(c);bb.command.scrollTo(c);absa.initializeNewContent(c);var r=bb.selector.query(n,"#policyNoToUnlink"+b);var m=bb.selector.query(n,"#policyNameToUnlink"+b);var k=bb.selector.query(n,"#policyTypeToUnlink"+b);if(r!=null){n.removeChild(r);if(m!=null){n.removeChild(m);if(k!=null){n.removeChild(k)}}}else{v.value=b;n.appendChild(v);absa.initializeNewContent(v);a.value=g;n.appendChild(a);absa.initializeNewContent(a);w.value=o;n.appendChild(w);absa.initializeNewContent(w)}}else{c.setAttribute("accountno",""+b);l.className="ap-icon ap-icon-addBen";l.onclick=function(){absa.apps.linkUnlinkPolicies.linkPolicy(l,b,g,o)};var q=bb.selector.query(n,"#ap-linkUnlink-linkTooltipText").value;l.setAttribute("tooltip",q);var s=bb.selector.queryAll(c,"td");s=bb.selector.queryAll(c,"td");c.removeChild(s[0]);c.removeChild(s[1]);c.removeChild(s[2]);c.appendChild(s[1]);c.appendChild(s[0]);c.appendChild(s[2]);bb.html.replaceClass(s[1],"ui-tableBodyCell ui-table-last-Column","ui-tableBodyCell");bb.html.replaceClass(s[0],"ui-tableBodyCell ap-common-alignLeft","ui-tableBodyCell");bb.html.setStyle(s[1].childNodes[0],"width","347px");j.appendChild(c);bb.command.scrollTo(c);absa.initializeNewContent(c);var r=bb.selector.query(n,"#policyNoToLink"+b);var m=bb.selector.query(n,"#policyNameToLink"+b);var k=bb.selector.query(n,"#policyTypeToLink"+b);if(r!=null){n.removeChild(r);if(m!=null){n.removeChild(m);if(k!=null){n.removeChild(k)}}}else{u.value=b;n.appendChild(u);absa.initializeNewContent(u);h.value=g;n.appendChild(h);absa.initializeNewContent(h);f.value=o;n.appendChild(f);absa.initializeNewContent(f)}}};absa.apps.linkUnlinkPolicies.unLinkPolicy=function(g,h,i,c){absa.apps.linkUnlinkPolicies.linkUnlinkPolicy(g,h,i,"unlink",c);var k=true;for(var j=0;j<absa.apps.linkUnlinkPolicies.theList.length;j=j+4){var d=absa.apps.linkUnlinkPolicies.theList[j];var a=absa.apps.linkUnlinkPolicies.theList[(j+1)];var f=absa.apps.linkUnlinkPolicies.theList[(j+2)];var b=absa.apps.linkUnlinkPolicies.theList[(j+3)];if(a==h){k=false;absa.apps.linkUnlinkPolicies.theList.splice(j,1);absa.apps.linkUnlinkPolicies.theList.splice(j,1);absa.apps.linkUnlinkPolicies.theList.splice(j,1);absa.apps.linkUnlinkPolicies.theList.splice(j,1)}}if(k){var e=absa.apps.linkUnlinkPolicies.theList.length;absa.apps.linkUnlinkPolicies.theList[e]="unlink";absa.apps.linkUnlinkPolicies.theList[(e+1)]=h;absa.apps.linkUnlinkPolicies.theList[(e+2)]=i;absa.apps.linkUnlinkPolicies.theList[(e+3)]=c}};absa.apps.linkUnlinkPolicies.beforeSubmitAccountsStep1=function(b){var c=bb.selector.queryAncestor(b,".ap-linkUnlink-form1");var a=bb.selector.query(c,".ap-linkUnlink-msgNothingChanged");if(absa.apps.linkUnlinkPolicies.theList.length==0){phe.common.show(a);bb.command.scrollTo(a);return false}else{phe.common.hide(a);absa.form.validateAndSubmit(c)}};absa.apps.linkUnlinkPolicies.beforeLinkUnlinkMore=function(d){absa.apps.linkUnlinkPolicies.resetMyArray();var b=bb.selector.queryAncestor(d,".ap-linkUnlink-root");var c=bb.selector.query(b,".ap-tabHead-linkUnlinkPolicies");var a=bb.selector.query(b,".ap-linkUnlink-tab-insure");phe.tabBox.selectTab(c)};absa.apps.linkUnlinkPolicies.validatePoliciesCallback=function(n,d){var o=bb.html.createElementFromString(d.text);if(d.status==200){var a=[];var h=bb.selector.queryAll(o,".ap-linkUnlink-resultMessages");for(var l=0;l<h.length;l++){var p=h[l];var i=p.getAttribute("data-accountno");var g=p.getAttribute("data-tobe");var c=p.innerHTML;if(g=="linked"){for(var m=0;m<absa.apps.linkUnlinkPolicies.theList.length;m=m+4){var f=absa.apps.linkUnlinkPolicies.theList[m];var e=absa.apps.linkUnlinkPolicies.theList[(m+1)];var k=absa.apps.linkUnlinkPolicies.theList[(m+2)];var j=absa.apps.linkUnlinkPolicies.theList[(m+3)];if(i==e){absa.index.addInsuranceGadget(e)}}setTimeout(function(){absa.util.observer.publish("insurancebalances","")},2000)}else{a[a.length]=i}}absa.form.wizardBridge.handleResponse(n,d);if(typeof a!="undefined"){if(a.length>0){for(var l=0;l<a.length;l++){var b=a[l];for(var m=0;m<absa.apps.linkUnlinkPolicies.theList.length;m=m+4){var f=absa.apps.linkUnlinkPolicies.theList[m];var e=absa.apps.linkUnlinkPolicies.theList[(m+1)];var k=absa.apps.linkUnlinkPolicies.theList[(m+2)];var j=absa.apps.linkUnlinkPolicies.theList[(m+3)];if(b==e){absa.apps.linkUnlinkPolicies.removeInsuranceGadget(e);absa.index.insurancePremiumBalances[a[l]]=0}}}}}setTimeout(function(){absa.util.observer.publish("insurancebalances",{})},2000);absa.apps.linkUnlinkPolicies.resetMyArray()}};absa.apps.linkUnlinkPolicies.removeInsuranceGadget=function(c){if(!absa.index.removeInsuranceGadget(c)){var b=bb.selector.queryAll(document.body,".ap-linkUnlink-msgPoliciesUnlinkedWillNotBeDisplayedOnNextLogon");for(var a=0;a<b.length;a++){phe.common.show(b[a])}}else{absa.index.refreshUpdaters(false)}};